<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MonBailZen — v7 (final)</title>
<style>
:root{
  --bg:#0e1014; --panel:#151822; --soft:#10121a; --text:#e6edf3; --muted:#9da7b1;
  --gold:#a0b04c; --accent:#66a8ff; --ok:#36d399; --warn:#fbbd23; --err:#ef4444;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:linear-gradient(180deg,#0b0f15,#0b0f15);
  color:var(--text); font:15px/1.5 Inter,system-ui,Segoe UI,Roboto,Arial}
.wrap{max-width:1200px;margin:0 auto;padding:16px}
.top{position:sticky;top:0;background:#0e1014e6;backdrop-filter:blur(8px);z-index:30;border-bottom:1px solid #1b2231}
.brand{display:flex;gap:10px;align-items:center;justify-content:space-between}
.logo{width:46px;height:46px;border-radius:12px;display:grid;place-items:center;
  font-weight:900;border:1px solid #293246;background:linear-gradient(135deg, #2a3347, #1c2435);color:#fff}
.title{font-size:18px}
.badge{display:inline-flex;gap:6px;align-items:center;font-size:12px;padding:3px 8px;border-radius:20px;border:1px solid #283146;background:#151b26}
.tabs{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
.tab{cursor:pointer;padding:9px 14px;border-radius:999px;border:1px solid #283146;background:#121722;color:var(--text)}
.tab.active{background:linear-gradient(135deg,#303b4f,#1d2536);color:#fff;border-color:#3a465f}
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid #303949;background:#1b2231;color:#fff;text-decoration:none;font-weight:600}
.btn.gold{background:linear-gradient(135deg,#b6c36a,#889743);color:#111;border:none}
.btn.outline{background:transparent}
.grid{display:grid;gap:16px}
@media(min-width:900px){ .grid.cols-2{grid-template-columns:1fr 1fr} .grid.cols-3{grid-template-columns:repeat(3,1fr)} }
.card{background:var(--panel);border:1px solid #283146;border-radius:18px;padding:16px}
.card h3{margin:0 0 10px;font-size:18px}
hr.sep{border:none;border-top:1px dashed #2b3547;margin:24px 0}
.kv{display:grid;grid-template-columns:140px 1fr;gap:6px 12px}
.kv label{color:var(--muted)}
input,select,textarea{width:100%;background:#0f1420;color:var(--text);border:1px solid #2b3547;border-radius:10px;padding:10px}
input[type="date"]{padding:8px 10px}
.small{font-size:12px;color:var(--muted)}
.right{display:flex;gap:10px;align-items:center}
.chips{display:flex;flex-wrap:wrap;gap:8px}
.chip{background:#0f1420;border:1px solid #2b3547;color:#cbd5e1;padding:4px 10px;border-radius:999px;font-size:12px}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid #253048;text-align:left}
tfoot td{font-weight:700}
.notice{padding:10px;border:1px solid #2b3547;background:#0f1420;border-radius:12px}
.ok{color:var(--ok)} .warn{color:var(--warn)} .err{color:var(--err)}
/* Modal */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:#0008;z-index:99}
.modal.open{display:flex}
.modal .box{width:min(760px,92vw);background:#151b24;border:1px solid #2b3547;border-radius:16px;padding:16px}
.modal header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.canvas{background:#fff;height:280px;border-radius:8px}
/* pills */
.pill{display:inline-block;padding:3px 8px;border-radius:6px;background:#0f1420;border:1px solid #2b3547;font-size:12px}
/* footer */
.footer{margin-top:28px;color:#9aa6b2;font-size:12px;text-align:center}
.hidden{display:none !important}
</style>
</head>
<body>
<header class="top">
  <div class="wrap nav">
    <div class="brand">
      <div class="logo">MBZ</div>
      <div class="title">MonBailZen <span class="badge">final</span></div>
    </div>
    <nav class="tabs" id="site-tabs">
      <button class="tab active" data-tab="home">Accueil</button>
      <button class="tab" data-tab="features">Fonctionnalités</button>
      <button class="tab" data-tab="pricing">Tarifs</button>
      <button class="tab" data-tab="faq">FAQ</button>
      <button class="tab" data-tab="contact">Contact</button>
      <a class="btn gold" id="open-demo">Essayer la démo</a>
    </nav>
  </div>
</header>

<main class="wrap" id="home" data-view>
  <div class="grid cols-2">
    <section class="card">
      <h2>Gérez vos locations en toute sérénité.</h2>
      <p class="small">Baux guidés, EDL multi-pièces + photos, signatures eIDAS (démo), IRL, comptabilité mensuelle & annuelle, exports PDF/CSV.</p>
      <div class="chips">
        <span class="chip">–70% temps de gestion</span>
        <span class="chip">ALUR • ELAN • eIDAS</span>
        <span class="chip">PDF + CSV</span>
        <span class="chip">Satisfaction 4,8/5</span>
      </div>
      <hr class="sep">
      <div class="right">
        <a class="btn gold" id="cta-demo">Démarrer la démo</a>
        <a class="btn outline" data-tabto="features">Voir les fonctionnalités</a>
      </div>
    </section>
    <section class="card">
      <h3>Pourquoi MonBailZen ?</h3>
      <ul class="small">
        <li>Formulaires guidés bailleur / locataire / garant</li>
        <li>EDL multi-pièces (murs, sols, plafonds, menuiseries, radiateurs, appareils) + photos + anomalies</li>
        <li>IRL, quittances & rappels automatiques</li>
        <li>Compta simple : loyers, charges, régularisation, bilan annuel</li>
        <li>Stockage local (démo) — vos données restent sur votre navigateur</li>
      </ul>
      <div class="notice small">Démo autonome (sans serveur) — signatures et PDF sont simulés.</div>
    </section>
  </div>
</main>

<main class="wrap hidden" id="features" data-view>
  <div class="grid cols-2">
    <section class="card">
      <h3>Baux (simulation complète)</h3>
      <div class="kv">
        <label>Type de bail</label>
        <select id="b_type">
          <option>Vide</option><option>Meublé</option><option>Colocation</option><option>Mobilité</option>
        </select>
        <label>Adresse du bien</label><input id="b_addr" placeholder="4 rue Exemples, 75000 Paris">
        <label>Loyer HC (€)</label><input id="b_rent" type="number" value="650">
        <label>Charges (€)</label><input id="b_chg" type="number" value="50">
        <label>Locataire</label><input id="b_tenant" placeholder="Prénom NOM">
        <label>Garant (optionnel)</label><input id="b_guarantor" placeholder="Nom du garant (facultatif)">
        <label>Date d’effet</label><input id="b_start" type="date">
        <label>IRL de référence</label><input id="b_irl" type="number" step="0.01" value="143.15">
      </div>
      <div class="right" style="margin-top:10px">
        <button class="btn" id="b_gen">Générer (aperçu)</button>
        <button class="btn outline" id="b_pdf">PDF (démo)</button>
        <button class="btn outline" id="b_sign">Signature (démo)</button>
      </div>
      <hr class="sep"><div id="b_preview" class="small"></div>
    </section>

    <section class="card">
      <h3>État des lieux (entrée/sortie)</h3>
      <div class="kv">
        <label>Type</label>
        <select id="edl_type"><option>Entrée</option><option>Sortie</option></select>
        <label>Pièces</label>
        <select id="edl_add_room">
          <option value="">— ajouter —</option>
          <option>Salon</option><option>Chambre</option><option>Cuisine</option><option>Salle de bain</option><option>WC</option>
          <option>Entrée</option><option>Balcon</option>
        </select>
      </div>
      <div id="rooms" class="grid" style="margin-top:10px"></div>
      <div class="right" style="margin-top:10px">
        <button class="btn" id="edl_sign">Signature (démo)</button>
        <button class="btn outline" id="edl_pdf">PDF (démo)</button>
      </div>
    </section>

    <section class="card">
      <h3>Comptabilité (démo)</h3>
      <div class="kv">
        <label>Mois</label>
        <input id="acc_month" type="month">
        <label>Loyer encaissé (€)</label><input id="acc_rent" type="number" value="0">
        <label>Charges encaissées (€)</label><input id="acc_chg" type="number" value="0">
        <label>Dépenses (€)</label><input id="acc_sp" type="number" value="0">
      </div>
      <div class="right" style="margin-top:10px">
        <button class="btn" id="acc_save">Enregistrer</button>
        <button class="btn outline" id="acc_csv">Export CSV</button>
      </div>
      <hr class="sep">
      <table id="acc_table"><thead><tr><th>Mois</th><th>Loyer</th><th>Charges</th><th>Dépenses</th><th>Solde</th></tr></thead><tbody></tbody><tfoot><tr><td>Total</td><td id="t_rent">0</td><td id="t_chg">0</td><td id="t_sp">0</td><td id="t_bal">0</td></tr></tfoot></table>
    </section>

    <section class="card">
      <h3>Outils IRL (démo)</h3>
      <div class="kv">
        <label>IRL N-1</label><input id="irl_prev" type="number" step="0.01" value="138.61">
        <label>IRL N</label><input id="irl_now" type="number" step="0.01" value="143.15">
        <label>Loyer actuel (€)</label><input id="irl_rent" type="number" value="650">
      </div>
      <div class="right" style="margin-top:10px">
        <button class="btn" id="irl_calc">Calculer</button>
      </div>
      <div id="irl_out" class="notice small" style="margin-top:12px"></div>
    </section>
  </div>
</main>

<main class="wrap hidden" id="pricing" data-view>
  <section class="card">
    <h3>Tarifs (démo)</h3>
    <div class="grid cols-3">
      <div class="card"><h3>Starter</h3><p class="small">1 bien</p><p class="ok"><b>0€</b>/mois</p><button class="btn gold">Essayer</button></div>
      <div class="card"><h3>Pro</h3><p class="small">Jusqu’à 10 biens</p><p class="ok"><b>9€</b>/mois</p><button class="btn gold">Choisir</button></div>
      <div class="card"><h3>Business</h3><p class="small">Illimité</p><p class="ok"><b>19€</b>/mois</p><button class="btn gold">Choisir</button></div>
    </div>
  </section>
</main>

<main class="wrap hidden" id="faq" data-view>
  <section class="card">
    <h3>FAQ</h3>
    <p><span class="pill">Données</span> Démo 100% locale (localStorage). Pas de serveur.</p>
    <p><span class="pill">Signature</span> Simulation eIDAS pour la démo.</p>
    <p><span class="pill">PDF</span> Aperçus imprimables (Ctrl/Cmd+P) en mode démo.</p>
  </section>
</main>

<main class="wrap hidden" id="contact" data-view>
  <section class="card">
    <h3>Contact</h3>
    <div class="kv">
      <label>Nom</label><input id="c_name">
      <label>Email</label><input id="c_mail" type="email">
      <label>Message</label><textarea id="c_msg" rows="4"></textarea>
    </div>
    <div class="right" style="margin-top:10px"><button class="btn" id="c_send">Envoyer (démo)</button></div>
    <div id="c_out" class="small" style="margin-top:8px"></div>
  </section>
</main>

<!-- Modal Signature -->
<div id="sig_modal" class="modal" aria-hidden="true">
  <div class="box" role="dialog" aria-modal="true" aria-labelledby="sig_t">
    <header>
      <strong id="sig_t">Signature (démo)</strong>
      <button class="btn outline" id="sig_close">Fermer</button>
    </header>
    <canvas id="sig_pad" class="canvas"></canvas>
    <div class="right" style="margin-top:10px">
      <button class="btn outline" id="sig_clear">Effacer</button>
      <button class="btn" id="sig_save">Enregistrer</button>
    </div>
  </div>
</div>

<footer class="footer wrap">© 2025 MonBailZen — Démo front-end autonome. eIDAS simulée. Données locales.</footer>

<script>
/* ---------- Navigation (onglets) ---------- */
const views = [...document.querySelectorAll('[data-view]')];
const tabs = [...document.querySelectorAll('.tab')];
function show(id){
  views.forEach(v=>v.classList.toggle('hidden', v.id!==id));
  tabs.forEach(t=>t.classList.toggle('active', t.dataset.tab===id));
  location.hash = '#'+id;
}
tabs.forEach(t=>t.addEventListener('click',()=>show(t.dataset.tab)));
document.querySelectorAll('[data-tabto]').forEach(a=>a.addEventListener('click',()=>show(a.getAttribute('data-tabto'))));
window.addEventListener('load',()=>{ const h=location.hash.replace('#','')||'home'; if(document.getElementById(h)) show(h); });
window.addEventListener('hashchange',()=>{ const h=location.hash.replace('#',''); if(document.getElementById(h)) show(h); });

/* ---------- Signature modal (pas d’auto-ouverture) ---------- */
const modal = document.getElementById('sig_modal');
const btnOpenDemo = document.getElementById('open-demo');
const btnCtaDemo  = document.getElementById('cta-demo');
const btnSigClose = document.getElementById('sig_close');
const btnSigClear = document.getElementById('sig_clear');
const btnSigSave  = document.getElementById('sig_save');
let drawing=false, ctx, pad, last;

function openModal(){ modal.classList.add('open'); modal.setAttribute('aria-hidden','false'); resizePad(); }
function closeModal(){ modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); }
function outside(e){ if(e.target===modal) closeModal(); }
function esc(e){ if(e.key==='Escape') closeModal(); }

[btnOpenDemo, btnCtaDemo].forEach(b=>b.addEventListener('click',()=>{ show('features'); openModal(); }));
btnSigClose.addEventListener('click', closeModal);
modal.addEventListener('click', outside);
document.addEventListener('keydown', esc);

/* Canvas signature */
function resizePad(){
  pad = document.getElementById('sig_pad');
  const dpr = Math.max(1, window.devicePixelRatio || 1);
  const rect = pad.getBoundingClientRect();
  pad.width = rect.width * dpr; pad.height = rect.height * dpr;
  ctx = pad.getContext('2d'); ctx.scale(dpr,dpr); ctx.lineWidth = 2; ctx.lineCap='round';
  ctx.fillStyle="#fff"; ctx.fillRect(0,0,rect.width,rect.height);
}
function pos(e){ const r = pad.getBoundingClientRect(); const t = (e.touches?e.touches[0]:e); return {x:t.clientX-r.left,y:t.clientY-r.top}; }
function down(e){ drawing=true; last=pos(e); }
function move(e){ if(!drawing) return; const p=pos(e); ctx.beginPath(); ctx.moveTo(last.x,last.y); ctx.lineTo(p.x,p.y); ctx.stroke(); last=p; }
function up(){ drawing=false; }

['mousedown','touchstart'].forEach(ev=>pad.addEventListener(ev,down));
['mousemove','touchmove'].forEach(ev=>pad.addEventListener(ev,move));
['mouseup','mouseleave','touchend','touchcancel'].forEach(ev=>pad.addEventListener(ev,up));
btnSigClear.addEventListener('click',resizePad);
btnSigSave.addEventListener('click',()=>{ try{ localStorage.setItem('mbz_sig', pad.toDataURL()); alert('Signature enregistrée (démo)'); closeModal(); }catch(e){ alert('Impossible de sauvegarder en local'); }});

/* ---------- Baux (aperçu/PDF/signature) ---------- */
function eur(n){ return (Number(n)||0).toLocaleString('fr-FR',{style:'currency',currency:'EUR'}); }
document.getElementById('b_gen').addEventListener('click',()=>{
  const t=document.getElementById('b_type').value,
        a=document.getElementById('b_addr').value,
        r=Number(document.getElementById('b_rent').value||0),
        c=Number(document.getElementById('b_chg').value||0),
        ten=document.getElementById('b_tenant').value||'[Locataire]',
        gar=document.getElementById('b_guarantor').value,
        d=document.getElementById('b_start').value||'[date]';
  const total=r+c;
  document.getElementById('b_preview').innerHTML =
  `<div class="notice">
    <b>Aperçu bail ${t}</b><br>
    Adresse: ${a}<br>
    Locataire: ${ten}${gar?` — Garant: ${gar}`:''}<br>
    Loyer HC: ${eur(r)} &bullet; Charges: ${eur(c)} &bullet; Total: <b>${eur(total)}</b><br>
    Date d’effet: ${d}
  </div>`;
  try{ localStorage.setItem('mbz_bail', JSON.stringify({t,a,r,c,ten,gar,d})); }catch{}
});
document.getElementById('b_pdf').addEventListener('click',()=>{ window.print(); });
document.getElementById('b_sign').addEventListener('click', openModal);

/* ---------- EDL ---------- */
const roomsBox = document.getElementById('rooms');
document.getElementById('edl_add_room').addEventListener('change', e=>{
  const name = e.target.value; if(!name) return; e.target.value='';
  const id = 'r_'+Math.random().toString(36).slice(2,7);
  const el = document.createElement('div');
  el.className='card';
  el.innerHTML = `
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
      <b>${name}</b>
      <button class="btn outline" data-del>Supprimer</button>
    </div>
    <div class="grid cols-3">
      ${['Murs','Sols','Plafond','Menuiseries','Électricité','Appareils'].map(k=>`
        <label class="small">${k}<br>
          <select data-k="${k}">
            <option>OK</option><option>À nettoyer</option><option>À réparer</option><option>Remplacer</option>
          </select>
        </label>`).join('')}
    </div>
    <div style="margin-top:8px" class="grid cols-2">
      <div>
        <label class="small">Photos (état)</label>
        <input type="file" accept="image/*" multiple data-photos>
        <div class="small" data-prev></div>
      </div>
      <div>
        <label class="small">Anomalies (photos)</label>
        <input type="file" accept="image/*" multiple data-issues>
        <div class="small" data-prev-issues></div>
      </div>
    </div>
    <label class="small" style="display:block;margin-top:8px">Commentaires</label>
    <textarea rows="2" placeholder="Observations…"></textarea>
  `;
  roomsBox.appendChild(el);
  el.querySelector('[data-del]').onclick=()=>el.remove();
  el.querySelector('[data-photos]').addEventListener('change', e=>previewFiles(e, el.querySelector('[data-prev]')));
  el.querySelector('[data-issues]').addEventListener('change', e=>previewFiles(e, el.querySelector('[data-prev-issues]')));
});
function previewFiles(e, box){ box.innerHTML=''; [...e.target.files].forEach(f=>{ const img=document.createElement('div'); img.textContent='• '+f.name; box.appendChild(img); }); }
document.getElementById('edl_sign').addEventListener('click', openModal);
document.getElementById('edl_pdf').addEventListener('click',()=>window.print());

/* ---------- Comptabilité ---------- */
const accTableT = document.querySelector('#acc_table tbody');
function refreshAcc(){
  const items = JSON.parse(localStorage.getItem('mbz_acc')||'[]');
  accTableT.innerHTML='';
  let tr=0, tc=0, ts=0;
  for(const it of items){
    const bal = (Number(it.rent)+Number(it.chg)-Number(it.sp))||0;
    tr+=Number(it.rent)||0; tc+=Number(it.chg)||0; ts+=Number(it.sp)||0;
    const row = document.createElement('tr');
    row.innerHTML=`<td>${it.month}</td><td>${eur(it.rent)}</td><td>${eur(it.chg)}</td><td>${eur(it.sp)}</td><td>${eur(bal)}</td>`;
    accTableT.appendChild(row);
  }
  document.getElementById('t_rent').textContent=eur(tr);
  document.getElementById('t_chg').textContent=eur(tc);
  document.getElementById('t_sp').textContent=eur(ts);
  document.getElementById('t_bal').textContent=eur(tr+tc-ts);
}
document.getElementById('acc_save').addEventListener('click',()=>{
  const month=document.getElementById('acc_month').value||'[mois]';
  const rent=Number(document.getElementById('acc_rent').value||0);
  const chg =Number(document.getElementById('acc_chg').value||0);
  const sp  =Number(document.getElementById('acc_sp').value||0);
  const items = JSON.parse(localStorage.getItem('mbz_acc')||'[]'); items.push({month,rent,chg,sp});
  localStorage.setItem('mbz_acc', JSON.stringify(items)); refreshAcc();
});
document.getElementById('acc_csv').addEventListener('click',()=>{
  const items = JSON.parse(localStorage.getItem('mbz_acc')||'[]');
  const rows = [['Mois','Loyer','Charges','Dépenses','Solde']];
  items.forEach(it=>rows.push([it.month,it.rent,it.chg,it.sp,(it.rent+it.chg-it.sp)]));
  const csv = rows.map(r=>r.join(';')).join('\n');
  const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([csv],{type:'text/csv;charset=utf-8'}));
  a.download='compta.csv'; a.click();
});
refreshAcc();

/* ---------- IRL ---------- */
document.getElementById('irl_calc').addEventListener('click',()=>{
  const p=Number(document.getElementById('irl_prev').value||0);
  const n=Number(document.getElementById('irl_now').value||0);
  const r=Number(document.getElementById('irl_rent').value||0);
  if(!p||!n||!r){ document.getElementById('irl_out').textContent='Renseignez IRL N-1, IRL N et Loyer.'; return; }
  const coef=n/p; const nv=(r*coef).toFixed(2);
  document.getElementById('irl_out').innerHTML=`Nouvel indice: <b>${n}</b> — Coefficient: <b>${coef.toFixed(4)}</b> — Loyer révisé: <b>${eur(nv)}</b>`;
});

/* ---------- Contact (démo) ---------- */
document.getElementById('c_send').addEventListener('click',()=>{
  const n=document.getElementById('c_name').value||'[Nom]';
  const m=document.getElementById('c_mail').value||'[Email]';
  const t=document.getElementById('c_msg').value||'[Message]';
  document.getElementById('c_out').textContent=`Merci ${n} — message enregistré en local (démo).`;
  try{ localStorage.setItem('mbz_contact', JSON.stringify({n,m,t,at:new Date().toISOString()})); }catch{}
});
</script>
</body>
</html>
